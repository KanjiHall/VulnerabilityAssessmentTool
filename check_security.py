import requests

input_file = 'notes.txt'

with open(input_file, 'r') as file:
    lines = file.readlines()

secure_ciphers = []
weak_ciphers = []

for line in lines:
    tls_part = line.strip()  # Remove any leading or trailing whitespace, including newlines

    api_url = f" https://ciphersuite.info/api/cs/{tls_part}"

    try:
        response = requests.get(api_url)
        response.raise_for_status()  # Raise an HTTPError for bad responses
        data = response.json()
        cipher_info = data.get(tls_part)

        if cipher_info:
            security_level = cipher_info.get("security")
            if security_level == "secure":
                secure_ciphers.append(tls_part)
            elif security_level == "weak":
                weak_ciphers.append(tls_part)
            else:
                print(f"Unknown security level for {tls_part}: {security_level}")
        else:
            print(f"No information found for {tls_part}")

    except requests.exceptions.HTTPError as http_err:
        print(f"HTTP error occurred for {tls_part}: {http_err}")
    except requests.exceptions.RequestException as req_err:
        print(f"Request error occurred for {tls_part}: {req_err}")
    except ValueError as json_err:
        print(f"JSON decoding error for {tls_part}: {json_err}")

print("Secure Ciphers:")
for cipher in secure_ciphers:
    print(cipher)

print("\nWeak Ciphers:")
for cipher in weak_ciphers:
    print(cipher)